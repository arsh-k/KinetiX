import numpy as np

# Function to calculate Theta_k for a given species (either H2 or H)
def calculate_theta_k(coefficients, Xi, T):
    T2 = T ** 2
    T3 = T ** 3
    theta_k = 0.0
    for (i, j), (a, b, c, d) in coefficients.items():
        theta_k += Xi[i] * Xi[j] * (a + b * T + c * T2 + d * T3)
    return theta_k

# Polynomial coefficients for H2 (Theta_k[0]) and H (Theta_k[3])
coefficients_H2 = {
    (0, 1): (0.43684775065654985, 8.179130716063673e-05, -4.409983424632112e-08, 7.764026096406138e-12),
    (0, 2): (0.07512906602970043, 0.0005821373733232406, -2.789469347324744e-07, 4.1171751399901774e-11),
    (0, 3): (-0.1486831085063039, -6.154097628114892e-05, 3.294695418936562e-08, -5.441105673765522e-12),
    (0, 4): (0.4129006503074195, 1.5890450946719692e-05, -6.619743146725541e-09, 1.577154319581956e-12),
    (0, 5): (0.419209457528095, 1.6133244927245867e-05, -6.720887777403143e-09, 1.6012520356325586e-12),
    (0, 6): (0.43853861830866225, 8.210788948418656e-05, -4.427052754464175e-08, 7.794077620294088e-12),
    (0, 7): (0.44013487621370945, 8.240675795916166e-05, -4.443166997731304e-08, 7.822447660081383e-12),
    (0, 8): (0.4405266841137433, 5.804720964762039e-05, -3.087501886475353e-08, 5.6393973615322755e-12)
}

coefficients_H = {
    (3, 0): (0.1486831085063039, 6.154097628114892e-05, -3.294695418936562e-08, 5.441105673765522e-12),
    (3, 1): (0.18049744191426212, 0.0005560025680354975, -2.731214138716887e-07, 4.100329482121085e-11),
    (3, 2): (-0.20563994325864202, 0.0009145765513564576, -3.9362729466494383e-07, 5.497392297391151e-11),
    (3, 4): (0.2420061080744563, 0.0004133921722127481, -2.079182496265959e-07, 3.180537545971026e-11),
    (3, 5): (0.24382711884890476, 0.00041650280280930093, -2.0948276127547166e-07, 3.20446997157522e-11),
    (3, 6): (0.1808454127330957, 0.0005570744539779636, -2.736479492171055e-07, 4.108234275707603e-11),
    (3, 7): (0.18117335302338639, 0.000558084638074157, -2.741441751782374e-07, 4.115684039202429e-11),
    (3, 8): (0.20452381682016654, 0.0005134692975381282, -2.541366164564522e-07, 3.837080492852087e-11)
}

coefficients_gri_H2 = {
    (0, 1): (-0.14055615823623815, -8.731119252632009e-05, 5.33289111977641e-08, -9.933133099348362e-12),
    (0, 2): (0.4040338180734052, 4.3913187040371816e-05, -2.8837418680696256e-08, 6.491018100908444e-12),
    (0, 3): (0.42097932388076803, 0.00013176034822188484, -8.356213291348258e-08, 1.6462477049447787e-11),
    (0, 4): (0.410207146855907, 4.458414706952411e-05, -2.9278032459360578e-08, 6.590195910237478e-12),
    (0, 5): (-0.02336835541426038, 0.0007803412525574137, -4.0900878758139534e-07, 6.760597831087543e-11),
    (0, 6): (0.42260877102772393, 0.00013227034125903625, -8.388556941411761e-08, 1.6526196892184638e-11),
    (0, 7): (0.4241470451120014, 0.00013275179846596762, -8.419090855185413e-08, 1.6586351394845193e-11),
    (0, 8): (0.38040305527294704, 1.8541918048095156e-05, -1.2145847009665001e-08, 3.2834845268165054e-12),
    (0, 9): (0.3809423941195093, 4.140345152568665e-05, -2.7189296586193986e-08, 6.120042097082562e-12),
    (0, 10): (0.31675698720380574, 0.00019403233220339802, -1.1861149942448134e-07, 2.2114754867139132e-11),
    (0, 11): (0.31675698720380574, 0.00019403233220339802, -1.1861149942448134e-07, 2.2114754867139132e-11),
    (0, 12): (0.3230430430851273, 0.0001978829120985798, -1.2096534968135597e-07, 2.255362311915867e-11),
    (0, 13): (0.33151167140310883, 0.0001956747523129665, -1.19877935992368e-07, 2.2410538643579533e-11),
    (0, 14): (0.4260063346251707, 0.0001029422701242526, -6.605478660586632e-08, 1.335493056733064e-11),
    (0, 15): (0.2727483948406757, 0.000444256213737158, -2.564206875276579e-07, 4.517805609771289e-11),
    (0, 16): (0.0832899877459297, 0.0007049485572398394, -3.820888443079354e-07, 6.436747714900983e-11),
    (0, 17): (0.08368124130304512, 0.0007082600433223214, -3.8388370136232877e-07, 6.46698424815963e-11),
    (0, 18): (0.10326978505779714, 0.0006832862649998391, -3.7256409333731787e-07, 6.299575926490007e-11),
    (0, 19): (0.10326978505779714, 0.0006832862649998391, -3.7256409333731787e-07, 6.299575926490007e-11),
    (0, 20): (0.09304006866488518, 0.0007017429702846238, -3.813649142916083e-07, 6.435087974169915e-11),
    (0, 21): (0.28801788608272844, 0.0003549660670218876, -2.0812449281534354e-07, 3.7168467918954027e-11),
    (0, 22): (0.2898309520757973, 0.00035720057028798167, -2.0943463173335245e-07, 3.740244257367452e-11),
    (0, 23): (0.29151824761115347, 0.00035928006844140745, -2.1065388770942148e-07, 3.762018665569157e-11),
    (0, 24): (0.2261957160138084, 0.00047737951700552097, -2.718434657850918e-07, 4.7380965455008936e-11),
    (0, 25): (0.2524664351597555, 0.0004370240250748299, -2.514212352522129e-07, 4.417834172755248e-11),
    (0, 26): (0.25364883967541235, 0.0004390707889651309, -2.525987446707148e-07, 4.438524713644071e-11),
    (0, 27): (0.3757816364807187, 0.0002497756264725188, -1.519471801869279e-07, 2.8168287832673846e-11),
    (0, 28): (0.12273324959083375, 0.0006833277792089861, -3.743953021884665e-07, 6.350086751509696e-11),
    (0, 29): (0.12273324959083375, 0.0006833277792089861, -3.743953021884665e-07, 6.350086751509696e-11),
    (0, 30): (0.39951911706003684, 1.9473688832060898e-05, -1.275620163197669e-08, 3.448486601477602e-12),
    (0, 31): (0.3973026128333653, 4.318159314294552e-05, -2.8356987153351596e-08, 6.382877709659015e-12),
    (0, 32): (0.4041888198465874, 4.393003370412637e-05, -2.8848481742357614e-08, 6.493508286810927e-12),
    (0, 33): (0.04973577876096719, 0.0006751837149800426, -3.627659519911092e-07, 6.079245074224627e-11),
    (0, 34): (0.46450728489149096, 2.2641395484369153e-05, -1.4831201654122469e-08, 4.009438048488819e-12),
    (0, 35): (0.43090626801181064, 0.00010226954902664029, -6.567221060070173e-08, 1.3303165571854868e-11),
    (0, 36): (0.3199589762650521, 0.00036427722478826486, -2.1457489564987233e-07, 3.848245277881025e-11),
    (0, 37): (0.28432317116878647, 0.0004240790192495425, -2.4596265703882435e-07, 4.351155694074328e-11),
    (0, 38): (0.4067606990229827, 0.00015710822117505688, -9.857793928315426e-08, 1.9056385292854407e-11),
    (0, 39): (0.4523348439002346, 3.326389640675223e-05, -2.1899876901072165e-08, 5.320296088664422e-12),
    (0, 40): (0.04844778552514458, 0.0007457344516851981, -3.9994318287700894e-07, 6.695135171022925e-11),
    (0, 41): (0.0487097828200012, 0.0007497672555108373, -4.021060069164387e-07, 6.73134131210318e-11),
    (0, 42): (0.37578524512150047, 0.00024977802507432736, -1.5194863933963395e-07, 2.8168558333471356e-11),
    (0, 43): (0.28372439648610137, 0.00042318592362137987, -2.454446682590403e-07, 4.3419923118930294e-11),
    (0, 44): (0.28372439648610137, 0.00042318592362137987, -2.454446682590403e-07, 4.3419923118930294e-11),
    (0, 45): (0.28372439648610137, 0.00042318592362137987, -2.454446682590403e-07, 4.3419923118930294e-11),
    (0, 46): (0.2830858091800708, 0.00042223344592366165, -2.4489223832337064e-07, 4.3322196549813434e-11),
    (0, 47): (0.4267887601393641, 0.0001012923163766744, -6.504468237751134e-08, 1.317604769693715e-11),
    (0, 48): (0.250542946024803, 0.00048060127013507516, -2.750058091744479e-07, 4.811401854842675e-11),
    (0, 49): (0.2510805759472946, 0.0004816325728673806, -2.7559593296326886e-07, 4.821726446533888e-11),
    (0, 50): (0.1230098510862549, 0.000684867781517275, -3.752390694805139e-07, 6.36439781650734e-11),
    (0, 51): (0.12327434837678987, 0.0006863403926372741, -3.760459131392997e-07, 6.378082622913849e-11),
    (0, 52): (0.39218562942233753, 0.00021517333721526464, -1.3238914809288237e-07, 2.4882701649207182e-11),
}

coefficients_gri_H = {
    (1, 0): (0.14055615823623815, 8.731119252632009e-05, -5.33289111977641e-08, 9.933133099348362e-12),
    (1, 2): (0.20986071043016535, 0.0005198968507020069, -2.9377618172865e-07, 5.090428044583798e-11),
    (1, 3): (0.143974655722218, 0.0006802480859864295, -3.746309067057502e-07, 6.375435506732025e-11),
    (1, 4): (0.2114398384026838, 0.000523808891516147, -2.9598674409664703e-07, 5.1287317239632065e-11),
    (1, 5): (-0.22262593247093523, 0.0009890235047051955, -4.656095953430319e-07, 7.28652764108136e-11),
    (1, 6): (0.14425221632517385, 0.0006815594978436247, -3.753531364678602e-07, 6.387726348700272e-11),
    (1, 7): (0.14451379948036766, 0.0006827954198286195, -3.7603379192808966e-07, 6.39930968289031e-11),
    (1, 8): (0.22773653568323768, 0.0004541880470276801, -2.5937454746739633e-07, 4.530803993392325e-11),
    (1, 9): (0.20386497407064674, 0.0005050433582951544, -2.8538297396117563e-07, 4.944994129692078e-11),
    (1, 10): (0.0576518547049071, 0.0007374366374009896, -3.965822582699676e-07, 6.649578474059173e-11),
    (1, 11): (0.0576518547049071, 0.0007374366374009896, -3.965822582699676e-07, 6.649578474059173e-11),
    (1, 12): (0.058212774961130864, 0.0007446114830317213, -4.004407816205051e-07, 6.714275149949348e-11),
    (1, 13): (0.06346269111974767, 0.0007442730885323258, -4.0083573415313436e-07, 6.726627332355672e-11),
    (1, 14): (0.16732256034446338, 0.0006360129431693833, -3.5296764277318415e-07, 6.037825319595418e-11),
    (1, 15): (-0.07963338936724908, 0.0009919829062216984, -5.119389770497446e-07, 8.39518599435205e-11),
    (1, 16): (-0.2174024153212571, 0.0010495252027885225, -5.049405401627768e-07, 7.99842199840087e-11),
    (1, 17): (-0.2179106503150712, 0.0010519787423779957, -5.06120970710009e-07, 8.017120401341227e-11),
    (1, 18): (-0.1921404688114803, 0.001057721123526447, -5.200352682134282e-07, 8.329692603817983e-11),
    (1, 19): (-0.1921404688114803, 0.001057721123526447, -5.200352682134282e-07, 8.329692603817983e-11),
    (1, 20): (-0.21450107256930506, 0.0010585782111137369, -5.115640162199778e-07, 8.122412760508615e-11),
    (1, 21): (-0.038018376484986835, 0.0009145140687768421, -4.777484010263955e-07, 7.883154659370246e-11),
    (1, 22): (-0.038137290334772096, 0.0009173744850919401, -4.792427020645069e-07, 7.90781158375986e-11),
    (1, 23): (-0.03824765886762622, 0.0009200293478570544, -4.806296205228497e-07, 7.930696626793184e-11),
    (1, 24): (-0.1111574761338516, 0.0009997117554764816, -5.100599068660364e-07, 8.317553375439429e-11),
    (1, 25): (-0.08598695980753275, 0.0009774166236365526, -5.03070801975551e-07, 8.238794289424274e-11),
    (1, 26): (-0.08618737738507466, 0.0009796947768480945, -5.042433545361225e-07, 8.257997191506778e-11),
    (1, 27): (0.05190156990531292, 0.0008267148310707563, -4.4316805242533515e-07, 7.416728949771174e-11),
    (1, 28): (-0.20282402630895863, 0.0010768086738983794, -5.267823586752067e-07, 8.416755206577468e-11),
    (1, 29): (-0.20282402630895863, 0.0010768086738983794, -5.267823586752067e-07, 8.416755206577468e-11),
    (1, 30): (0.23328339720858532, 0.0004652504714584717, -2.656919997867651e-07, 4.6411584536885074e-11),
    (1, 31): (0.20812753578624466, 0.0005156031835242631, -2.913499751692712e-07, 5.048387774875015e-11),
    (1, 32): (0.20990048103114914, 0.0005199953761014429, -2.938318551100467e-07, 5.091392729128265e-11),
    (1, 33): (-0.20269301530403336, 0.0010014385642889358, -4.840562375259928e-07, 7.686531782998777e-11),
    (1, 34): (0.2513732244126179, 0.0005013280525367446, -2.862949335908355e-07, 5.001054425280607e-11),
    (1, 35): (0.16970957047063295, 0.0006365859453232512, -3.5346239531611486e-07, 6.048360460918871e-11),
    (1, 36): (-0.027619846168782547, 0.000934641122923446, -4.899376501090619e-07, 8.098758374645035e-11),
    (1, 37): (-0.06719483111859792, 0.0009785844927382653, -5.069821024577986e-07, 8.330021404597803e-11),
    (1, 38): (0.12074840636920044, 0.0007135779299759623, -3.902908331803126e-07, 6.612318858711702e-11),
    (1, 39): (0.23690760599815155, 0.0005182748270761303, -2.9460762286048655e-07, 5.127847674121725e-11),
    (1, 40): (-0.23058887994728466, 0.0010277606780849866, -4.843560504305111e-07, 7.584553367294638e-11),
    (1, 41): (-0.2312090188734159, 0.0010305247073034544, -4.856586632940064e-07, 7.604951041275551e-11),
    (1, 42): (0.05190181865928805, 0.0008267187933517908, -4.4317017644235377e-07, 7.41676449668941e-11),
    (1, 43): (-0.06712415281398677, 0.0009775551770870858, -5.06448837709121e-07, 8.321259543471726e-11),
    (1, 44): (-0.06712415281398677, 0.0009775551770870858, -5.06448837709121e-07, 8.321259543471726e-11),
    (1, 45): (-0.06712415281398677, 0.0009775551770870858, -5.06448837709121e-07, 8.321259543471726e-11),
    (1, 46): (-0.06704869851838759, 0.0009764563068207403, -5.058795383151577e-07, 8.311905611411823e-11),
    (1, 47): (0.16889974615854686, 0.0006335482687930158, -3.5177573473114346e-07, 6.019498745130035e-11),
    (1, 48): (-0.10171029415477163, 0.0010135145412591448, -5.192901778464605e-07, 8.48549216643278e-11),
    (1, 49): (-0.10181918847788032, 0.0010145996426176869, -5.198461466612783e-07, 8.49457700806805e-11),
    (1, 50): (-0.20305206263926118, 0.0010780193366665123, -5.273746233975681e-07, 8.426218217467108e-11),
    (1, 51): (-0.20326989677161172, 0.0010791758351653077, -5.27940390579255e-07, 8.435257859369048e-11),
    (1, 52): (0.07836454840040595, 0.0007884705367022887, -4.2582907528244936e-07, 7.158017638948254e-11),
}

# Example initial values for Xi
np.random.seed(42)
Xi = np.random.uniform(0.0, 1.0, 53)  # Initial values, need normalization

# Normalize Xi values so that their sum equals 1
Xi_sum = sum(Xi)
Xi_normalized = [x / Xi_sum for x in Xi]

# Input the temperature in Kelvin
T = float(input("Enter the temperature in Kelvin: "))

# Calculate Theta_k[0] for H2 and Theta_k[3] for H
theta_k_H2 = calculate_theta_k(coefficients_gri_H2, Xi_normalized, T)
theta_k_H = calculate_theta_k(coefficients_gri_H, Xi_normalized, T)

print("Thernal Diffustion Ratio - KinetiX")
print(f"Theta_k[0] for H2 at {T} K: {theta_k_H2:.3e}")
print(f"Theta_k[3] for H at {T} K: {theta_k_H:.3e}")
